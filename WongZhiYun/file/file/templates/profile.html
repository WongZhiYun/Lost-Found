{% extends "base.html" %}
{% block title %}Profile{% endblock %}
{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='profile.css') }}">
<link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">

<!-- Back button -->
<a href="{{ url_for('views.profile') }}" class="back-link">
    <i class='bx bx-chevrons-left'></i> Back
</a>

<div class="profile-container">
    <!--User Header-->
    <div class="profile-header">
        {% if user.profile_image %}
            <img src="{{ url_for('static', filename='profile_pics/' + user.profile_image) }}" 
            alt="Profile Picture" class="profile-img">
        {% else %}
            <div class="profile-avatar">
            {{ user.username[0]|upper }}
            </div>
        {% endif %}
        <div class="profile-info">
            <h2>{{ user.username }}</h2>
            <p>Email: {{ user.email }}</p>
            <p>Joined: {{ user.date_created.strftime('%Y-%m-%d') }}</p>
            {% if current_user.is_authenticated and current_user.id == user.id %}
            <div class="profile-actions">
                <a href="{{ url_for('views.edit_profile') }}">Edit Profile</a>
                <a href="{{ url_for('auth.logout') }}">Logout</a>
            </div>
            {% endif %}
        </div>
    </div>

    <!--User Posts-->
    <div class="profile-posts">
        <h2>Your Posts</h2>
        {% for post in posts %}
            <div class="post-card">
                {% if post.image %}
                <img src="{{ url_for('static', filename='uploads/' ~ post.image) }}" alt="Post image">
                {% endif %}
                <h4>{{ post.title }}</h4>
                <p>{{ post.description }}</p>
                <small>{{ post.date_posted.strftime('%Y-%m-%d') }}</small>
                {% if post.is_closed %}
                    <span class="badge found">Founded</span>
                {% else %}
                    <span class="badge {{ post.type }}">{{ post.type|capitalize }}</span>
                    <!-- Close button -->
                    <form action="{{ url_for('views.close_post', post_id=post.id) }}" method="POST" style="margin-top:5px;">
                        <button type="submit" class="btn-close">Mark as Founded</button>
                    </form>
                {% endif %}
            </div>
        {% else %}
            <p>You havenâ€™t posted anything yet.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}



